# Repository Guidelines

## Project Structure & Module Organization
- `cmd/main.go` is the service entrypoint.
- `pkg/` holds application code:
  - `pkg/api/` request/response models and handlers.
  - `pkg/service/` business logic and integrations (Argo CD, Tekton, Mongo, etc.).
  - `pkg/router/` Gin routes and middleware.
  - `pkg/config/` configuration loading and client initialization.
- `config/config.yaml` provides local defaults. Config can also be loaded from `/etc/devflow/config/`.
- `docs/` contains Swagger output generated by `swag` (do not hand-edit).
- `manifests/` contains deployment assets.
- `Dockerfile` builds the service and regenerates Swagger docs.

## Build, Test, and Development Commands
- `go run ./cmd` - run the API locally using `config/config.yaml`.
- `go build -o devflow cmd/main.go` - build the binary.
- `go test ./...` - run all Go tests (none exist yet, but use this for new tests).
- `swag init -g cmd/main.go --parseDependency` - regenerate `docs/` after API changes.
- `docker build -t devflow:local .` - container build (includes Swagger generation).

## Coding Style & Naming Conventions
- Format with `gofmt` (tabs, standard Go style).
- Packages are lowercase; exported types/functions use `CamelCase`.
- File names follow lowercase with underscores where needed (e.g., `configuration.go`).

## Testing Guidelines
- Use Go's `testing` package with `*_test.go` files alongside the code under test.
- Prefer unit tests in `pkg/service/` and `pkg/api/` for business and handler logic.
- Run `go test ./...` before opening a PR.

## Commit & Pull Request Guidelines
- Recent commits use short, lowercase, imperative summaries like `add ...`, `update ...`, `fix ...`; occasional `fix:` prefixes appear. Follow that pattern.
- In PRs, describe behavior changes, config updates, and API changes. If routes change, regenerate Swagger docs and mention it.

## Configuration & Runtime Notes
- The service expects a valid kubeconfig at `$HOME/.kube/config` or in-cluster config.
- `config/config.yaml` includes Mongo, logging, OTel, and repo settings; update it when wiring new dependencies.
